## Seriph

Seriph is a Next.js 15 web application for curating and exploring font families. Authenticated users can upload font files, group them into families, and browse rich metadata, cover art, and test specimens generated by Firebase Cloud Functions.

### Architecture
- **Web app**: Next.js App Router (React 18, TypeScript, Tailwind) located under `app/`, `components/`, and `lib/`.
- **Data**: Firebase Auth, Firestore, and Cloud Storage. Client utilities live in `lib/db` and `lib/firebase`.
- **Processing**: Cloud Functions in `functions/src` parse uploaded fonts, enrich metadata (Vertex AI), and write canonical family documents.

### Requirements
- Node.js 22 (see `.nvmrc`)
- npm 10+
- A Firebase project with Firestore + Storage enabled
- Service account credentials for admin access (used by Next.js API routes and scripts)

### Environment Variables
Create `.env.local` using the template in `.env.example`. Key values:
- `NEXT_PUBLIC_FIREBASE_*`: client SDK configuration
- `FIREBASE_ADMIN_*` and `FIREBASE_STORAGE_BUCKET`: service account credentials for admin actions
- `UPLOAD_SECRET_TOKEN`: optional dev bypass for authenticated uploads
- `GOOGLE_CLOUD_PROJECT`, `GOOGLE_CLOUD_LOCATION`: defaults for Vertex AI helpers inside Cloud Functions

Never commit secretsâ€”store production values in your deployment platform (Vercel, GitHub Actions, Firebase).

### Install & Run
```bash
npm install          # install pinned dependencies
npm run dev          # start Next.js (http://localhost:3000)
```

### Quality Gates
```bash
npm run lint:web         # ESLint over the web app (Next + TypeScript rules)
npm run lint:functions   # Delegate linting to the Firebase Functions package
npm run typecheck        # Strict TypeScript check (no emit)
npm test                 # Vitest unit tests
npm run build            # Production Next.js build
```

The `lint` script runs both lint jobs to mirror CI behaviour.

### Firebase Functions
Functions live in the `functions/` directory with their own TypeScript configuration and npm project. To work on functions:
```bash
cd functions
npm install
npm run build
```
Use `firebase emulators:start --only functions,firestore,storage` for local integration testing.

### Repository Docs
Refer to `docs/pipeline-recovery-plan.md` for the full recovery roadmap and `TODO.md` for the current execution checklist.

### Useful Scripts
- `scripts/reset.js`: destructive helper that clears Firestore `fontfamilies` collection and Storage assets. Requires admin credentials.

### Contributing Notes
- Always run `npm run lint && npm run typecheck && npm test` before pushing.
- When touching Firebase Functions, keep `functions/package.json` in sync and update CI workflows if new scripts are added.
- Document new environment variables in `.env.example`.
